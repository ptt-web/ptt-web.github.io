<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		

<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Re: [交易] polygon 穩定的 Websocket - 看板 DigiCurrency - 批踢踢實業坊</title>
<meta name="robots" content="all">
<meta name="keywords" content="Ptt BBS 批踢踢">
<meta name="description" content="經過幾天踩坑今天終於架好了，跟大家分享一下踩坑過程，有想要自己架設RPC可以參考
設備
VM
CPU 3600 切4核
RAM 8G
">
<meta property="og:site_name" content="Ptt 批踢踢實業坊">
<meta property="og:title" content="Re: [交易] polygon 穩定的 Websocket">
<meta property="og:description" content="經過幾天踩坑今天終於架好了，跟大家分享一下踩坑過程，有想要自己架設RPC可以參考
設備
VM
CPU 3600 切4核
RAM 8G
">
<link rel="canonical" href="https://www.ptt.cc/bbs/DigiCurrency/M.1624948222.A.8D3.html">

<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/bbs-common.css">
<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/bbs-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/bbs-custom.css">
<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/pushstream.css" media="screen">
<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/bbs-print.css" media="print">




	<script async src='/cdn-cgi/challenge-platform/h/g/scripts/invisible.js?ts=1653465600'></script></head>
    <body>
		
<div id="topbar-container">
	<div id="topbar" class="bbs-content">
		<a id="logo" href="/bbs/">批踢踢實業坊</a>
		<span>&rsaquo;</span>
		<a class="board" href="/bbs/DigiCurrency/index.html"><span class="board-label">看板 </span>DigiCurrency</a>
		<a class="right small" href="/about.html">關於我們</a>
		<a class="right small" href="/contact.html">聯絡資訊</a>
	</div>
</div>
<div id="navigation-container">
	<div id="navigation" class="bbs-content">
		<a class="board" href="/bbs/DigiCurrency/index.html">返回看板</a>
		<div class="bar"></div>
	</div>
</div>
<div id="main-container">
    <div id="main-content" class="bbs-screen bbs-content"><div class="article-metaline"><span class="article-meta-tag">作者</span><span class="article-meta-value">MACD (MACD)</span></div><div class="article-metaline-right"><span class="article-meta-tag">看板</span><span class="article-meta-value">DigiCurrency</span></div><div class="article-metaline"><span class="article-meta-tag">標題</span><span class="article-meta-value">Re: [交易] polygon 穩定的 Websocket</span></div><div class="article-metaline"><span class="article-meta-tag">時間</span><span class="article-meta-value">Tue Jun 29 14:30:16 2021</span></div>
經過幾天踩坑今天終於架好了，跟大家分享一下踩坑過程，有想要自己架設RPC可以參考

設備
VM
CPU 3600 切4核
RAM 8G
HDD 500G以上最好1T以上
OS  Ubuntu 20

先按照官方這篇非常簡單的步驟，裡面一堆坑要去找答案。
<a href="https://docs.matic.network/docs/develop/network-details/full-node-deployment" target="_blank" rel="noreferrer noopener nofollow">https://docs.matic.network/docs/develop/network-details/full-node-deployment</a>

坑1. Clone the <a href="https://github.com/maticnetwork/node-ansible" target="_blank" rel="noreferrer noopener nofollow">https://github.com/maticnetwork/node-ansible</a>
先 sudo apt git install，因為我有用github，所以這個我知道，裝完下這指令
git clone <a href="https://github.com/maticnetwork/node-ansible" target="_blank" rel="noreferrer noopener nofollow">https://github.com/maticnetwork/node-ansible</a>

坑2. ansible sentry -m ping
要安裝SSH連線憑證，SSH我之前一直沒搞清楚過，按照下面這一篇解決
<a href="https://blog.gtwang.org/linux/linux-ssh-public-key-authentication/" target="_blank" rel="noreferrer noopener nofollow">https://blog.gtwang.org/linux/linux-ssh-public-key-authentication/</a>

坑3. ansible-playbook -l sentry playbooks/network.yml
--extra-var=&#34;bor_branch=v0.2.6 heimdall_branch=v0.2.1-mainnet
network_version=mainnet-v1 node_type=sentry/sentry&#34;

安裝指令，但是出現要求sudo密碼，找了一些文章，指令最後加上--ask-become-pass，
也就是
ansible-playbook -l sentry playbooks/network.yml
--extra-var=&#34;bor_branch=v0.2.6 heimdall_branch=v0.2.1-mainnet
network_version=mainnet-v1 node_type=sentry/sentry&#34; --ask-become-pass

輸入後就會要你打sudo密碼，然後一路安裝完。

坑4. sudo service heimdalld start

安裝完不要急著打啟動節點同步，你會同步到天荒地失去耐性，以天算。去官方論壇下載
快照檔案直接灌進去
<a href="https://forum.matic.network/t/berlin-fork-upgrade-matic-mainnet/875" target="_blank" rel="noreferrer noopener nofollow">https://forum.matic.network/t/berlin-fork-upgrade-matic-mainnet/875</a>

裝完快照再打
sudo service heimdalld start
sudo service heimdalld-rest-server start
只要同步最多7天的資料。

坑5. 同步完heimdalld，一樣先不要開sudo service bor start

同上網址下載bor快照灌進去(190G)，灌完先不要開，要改設定檔，可以參考我的。

~/node/bor/start.sh

bor --datadir $DATA_DIR \
  --port 30303 \
  --http --http.addr &#39;0.0.0.0&#39; \
  --http.vhosts &#39;*&#39; \
  --http.corsdomain &#39;*&#39; \
  --ws \
  --ws.addr &#39;0.0.0.0&#39; \
  --ws.port 8545 \
  --ws.origins &#39;*&#39; \
  --ws.api &#39;eth,net,web3,admin,debug,txpool,bor&#39; \
  --ipcpath $DATA_DIR/bor.ipc \
  --http.api &#39;eth,net,web3,admin,debug,txpool,bor&#39; \
  --syncmode &#39;full&#39; \
  --networkid &#39;137&#39; \
  --miner.gaslimit &#39;20000000&#39; \
  --miner.gastarget &#39;20000000&#39; \
  --txpool.nolocals \
  --txpool.accountslots &#39;128&#39; \
  --txpool.globalslots &#39;20000&#39;  \
  --txpool.lifetime &#39;0h16m0s&#39; \
  --maxpeers 200 \
  --metrics \
  --pprof --pprof.port 7071 --pprof.addr &#39;0.0.0.0&#39; \
  --snapshot=false \
  --bootnodes 這裡請打官方文件的說明，長長一串我就省略了。

做到這邊，恭喜你已經架好自己的polygon full node

錢包連結用：<a href="http://IP:8545" target="_blank" rel="noreferrer noopener nofollow">http://IP:8545</a>
web3 websockets報價連結用:ws://IP:8545
--
覺得有幫助的大鯨可以贊助我喔&gt;.^
bitcoincash:qqev5n68g60a8ljl05kjk277gehaf5ra6sf276er4a

--
<span class="f2">※ 發信站: 批踢踢實業坊(ptt.cc), 來自: 59.127.53.93 (臺灣)
</span><span class="f2">※ 文章網址: <a href="https://www.ptt.cc/bbs/DigiCurrency/M.1624948222.A.8D3.html" target="_blank" rel="noreferrer noopener nofollow">https://www.ptt.cc/bbs/DigiCurrency/M.1624948222.A.8D3.html</a>
</span><div class="push"><span class="hl push-tag">推 </span><span class="f3 hl push-userid">minminpp</span><span class="f3 push-content">: 感謝分享，想請問所以需要兩個machine嗎？ 一個sentry</span><span class="push-ipdatetime"> 06/29 14:53
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">minminpp</span><span class="f3 push-content">:  一個validator 謝謝</span><span class="push-ipdatetime"> 06/29 14:53
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">MACD</span><span class="f3 push-content">: 按照官方文件會架在同一個machine上</span><span class="push-ipdatetime"> 06/29 14:55
</span></div><div class="push"><span class="hl push-tag">推 </span><span class="f3 hl push-userid">boogieman</span><span class="f3 push-content">: 真厲害 你是用pc跑還是租VPS?</span><span class="push-ipdatetime"> 06/29 16:03
</span></div><div class="push"><span class="hl push-tag">推 </span><span class="f3 hl push-userid">minminpp</span><span class="f3 push-content">: 不好意思再追問一下，所以是在本機上開VM，都裝在VM上再</span><span class="push-ipdatetime"> 06/29 17:01
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">minminpp</span><span class="f3 push-content">: 用本機連過去嗎？ 我有點不太懂為什麼需要VM</span><span class="push-ipdatetime"> 06/29 17:01
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">MACD</span><span class="f3 push-content">: 更正：沒有裝驗證節點，我只有裝sentry</span><span class="push-ipdatetime"> 06/29 17:29
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">MACD</span><span class="f3 push-content">: 因為我本機是windows系統，懶得另外架一台linux，而且VM打</span><span class="push-ipdatetime"> 06/29 17:30
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">MACD</span><span class="f3 push-content">: 掉比較方便</span><span class="push-ipdatetime"> 06/29 17:30
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">MACD</span><span class="f3 push-content">: vm可以有自己的IP，在連進去就好</span><span class="push-ipdatetime"> 06/29 17:31
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">MACD</span><span class="f3 push-content">: 我又踩到一個坑，裝在HHD上bor同步超慢，比區塊產生速度還</span><span class="push-ipdatetime"> 06/29 17:32
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">MACD</span><span class="f3 push-content">: 慢，我看要再買一塊SSD了</span><span class="push-ipdatetime"> 06/29 17:32
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">boogieman</span><span class="f3 push-content">: 你不如去租個VPS帳號 愛開幾個就有幾個</span><span class="push-ipdatetime"> 06/29 18:07
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">boogieman</span><span class="f3 push-content">: 請問節點有收入嗎?</span><span class="push-ipdatetime"> 06/29 18:09
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">MACD</span><span class="f3 push-content">: 要架驗證節點又有人質押才有收入，我是為了降低報價延遲.</span><span class="push-ipdatetime"> 06/29 18:18
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">MACD</span><span class="f3 push-content">: ..</span><span class="push-ipdatetime"> 06/29 18:18
</span></div><div class="push"><span class="hl push-tag">推 </span><span class="f3 hl push-userid">boogieman</span><span class="f3 push-content">: 原來如此...大大要不要試試看用樹莓派架看看啊 有人用</span><span class="push-ipdatetime"> 06/29 18:27
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">boogieman</span><span class="f3 push-content">: 樹莓派架BTC node 很有趣喔</span><span class="push-ipdatetime"> 06/29 18:27
</span></div><div class="push"><span class="hl push-tag">推 </span><span class="f3 hl push-userid">wlsh5701</span><span class="f3 push-content">: 教學推</span><span class="push-ipdatetime"> 06/29 18:28
</span></div><div class="push"><span class="hl push-tag">推 </span><span class="f3 hl push-userid">usttsu</span><span class="f3 push-content">: 這種能用docker 嗎</span><span class="push-ipdatetime"> 06/29 20:07
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">MACD</span><span class="f3 push-content">: 可以docker我要看到一篇教學，不過我沒試</span><span class="push-ipdatetime"> 06/29 20:45
</span></div><div class="push"><span class="hl push-tag">推 </span><span class="f3 hl push-userid">g12288</span><span class="f3 push-content">: 推踩坑</span><span class="push-ipdatetime"> 06/29 21:10
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">ECZEMA</span><span class="f3 push-content">: 讚喔~</span><span class="push-ipdatetime"> 06/30 02:48
</span></div><div class="push"><span class="hl push-tag">推 </span><span class="f3 hl push-userid">egg87346</span><span class="f3 push-content">: 好玩給推</span><span class="push-ipdatetime"> 06/30 08:47
</span></div><div class="push"><span class="hl push-tag">推 </span><span class="f3 hl push-userid">DarkerDuck</span><span class="f3 push-content">: 若要收PCH需使用simpleledger開頭的地址</span><span class="push-ipdatetime"> 07/12 04:36
</span></div></div>
    
    <div id="article-polling" data-pollurl="/poll/DigiCurrency/M.1624948222.A.8D3.html?cacheKey=2148-161338922&amp;offset=5300&amp;offset-sig=eb2c7b028372cf6767c62e95436c46415c900da3" data-longpollurl="/v1/longpoll?id=ef828ce5d727b5c16356906a2b0b3a966f756f4a" data-offset="5300"></div>
    

    
</div>

		

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-32365737-1', {
    cookieDomain: 'ptt.cc',
    legacyCookieDomain: 'ptt.cc'
  });
  ga('send', 'pageview');
</script>


		
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="//images.ptt.cc/bbs/v2.27/bbs.js"></script>

    <script type="text/javascript">(function(){window['__CF$cv$params']={r:'710ce28eadd22023',m:'HQEXQvNtwEc.OBFgTTGLO3ceWaxzTvb4BxhbYo2tYp8-1653467174-0-AXiwARYApKCYqYlV08S+B0Ph9yuJxQWaaSbTC7t2smQeF3DGJUMRh4fE5mXOoujd0GGKrajv75cEG6Irdy9dQENh9uChzLZCculOgWXs/qSzjDPk1nwrbfinNG5ZtspxSoADfqTFhMBZOPdezZ7Gcc9+xga8PKNz9ps9DooX9uFe',s:[0xc24eab3247,0x003745c66e],u:'/cdn-cgi/challenge-platform/h/g'}})();</script></body>
</html>
