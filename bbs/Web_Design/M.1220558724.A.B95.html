<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		

<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Re: [問題] 問個搜尋引擎機器人的問題還有HTTP 304 … - 看板 Web_Design - 批踢踢實業坊</title>
<meta name="robots" content="all">
<meta name="keywords" content="Ptt BBS 批踢踢">
<meta name="description" content="你這個問題其實不是只有對岸不禮貌
我家的伺服器每分鐘都被這種機器人打得亂七八糟
大約每分鐘都有超過兩千個 requests 是這種不合法的
來源多半是美國當地的，也有新加坡的，跟少數大陸的
更扯的是，我們追蹤回去，其中有一個 ip block 是政府的
">
<meta property="og:site_name" content="Ptt 批踢踢實業坊">
<meta property="og:title" content="Re: [問題] 問個搜尋引擎機器人的問題還有HTTP 304 …">
<meta property="og:description" content="你這個問題其實不是只有對岸不禮貌
我家的伺服器每分鐘都被這種機器人打得亂七八糟
大約每分鐘都有超過兩千個 requests 是這種不合法的
來源多半是美國當地的，也有新加坡的，跟少數大陸的
更扯的是，我們追蹤回去，其中有一個 ip block 是政府的
">
<link rel="canonical" href="https://www.ptt.cc/bbs/Web_Design/M.1220558724.A.B95.html">

<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/bbs-common.css">
<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/bbs-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/bbs-custom.css">
<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/pushstream.css" media="screen">
<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/bbs-print.css" media="print">




	<script async src='/cdn-cgi/challenge-platform/h/g/scripts/invisible.js?ts=1653465600'></script></head>
    <body>
		
<div id="topbar-container">
	<div id="topbar" class="bbs-content">
		<a id="logo" href="/bbs/">批踢踢實業坊</a>
		<span>&rsaquo;</span>
		<a class="board" href="/bbs/Web_Design/index.html"><span class="board-label">看板 </span>Web_Design</a>
		<a class="right small" href="/about.html">關於我們</a>
		<a class="right small" href="/contact.html">聯絡資訊</a>
	</div>
</div>
<div id="navigation-container">
	<div id="navigation" class="bbs-content">
		<a class="board" href="/bbs/Web_Design/index.html">返回看板</a>
		<div class="bar"></div>
	</div>
</div>
<div id="main-container">
    <div id="main-content" class="bbs-screen bbs-content"><div class="article-metaline"><span class="article-meta-tag">作者</span><span class="article-meta-value">jsu (Je me souviens)</span></div><div class="article-metaline-right"><span class="article-meta-tag">看板</span><span class="article-meta-value">Web_Design</span></div><div class="article-metaline"><span class="article-meta-tag">標題</span><span class="article-meta-value">Re: [問題] 問個搜尋引擎機器人的問題還有HTTP 304 …</span></div><div class="article-metaline"><span class="article-meta-tag">時間</span><span class="article-meta-value">Fri Sep  5 04:05:20 2008</span></div>
<span class="f2">※ 引述《globalhawk (Cory)》之銘言：
</span><span class="f6">: 我自己架的網頁server有用robots.txt在攔搜尋引擎的機器人
</span><span class="f6">: 但是最近檢查紀錄時 發現某家搜尋引擎的機器人真的非常糟糕
</span><span class="f6">: 就是大陸的 Sogou 根本完全無視robots.txt嘛
</span><span class="f6">: 早在第一次領教到大陸沒禮貌機器人的威力後
</span><span class="f6">: 就用robots.txt並且也用來源IP封鎖的方式
</span>
你這個問題其實不是只有對岸不禮貌
我家的伺服器每分鐘都被這種機器人打得亂七八糟
大約每分鐘都有超過兩千個 requests 是這種不合法的

來源多半是美國當地的，也有新加坡的，跟少數大陸的
更扯的是，我們追蹤回去，其中有一個 ip block 是政府的

對於這種不尊重 robots.txt 的機器人
我們的做法是把 ip 記錄下來，然後 reverse proxy servers 會把 list 取回
接著將那些 ip 餵給 iptables 擋一擋
然後我們公司有臺 ghost server ，也會取得 ip list
最後利用常見的系統漏洞，再用程式反擊回去

整個流程全自動，還挺方便的

不過要注意的是， robots / web-crawlers 會 cache robots.txt
所以如果你的 robots.txt 太常更新，這個方法要調整一下，多加幾個驗證條件

<span class="f6">: 更莫名奇妙的是 他們家的機器人每次讀robots.txt伺服器都是回應304
</span><span class="f6">: (別家是一直都 200)
</span><span class="f6">: 到底是在玩什麼把戲啊 304 (not modified)正常來說多半是用在圖片資料上吧?
</span><span class="f6">: 而且在用過幾次304後應該也會正常下載一次資料(200)才對?
</span><span class="f6">: 所以想問問看有沒有人有成功用robots.txt把Sogou擋掉過?
</span><span class="f6">: 另外就是在user端用何種方法要求時server端會給304 ?
</span><span class="f6">: p.s. 我用的是Apache 2.0
</span>

不知道也沒去注意過

--

乘長風，破巨浪　我海軍勇向前航

--
<span class="f2">※ 發信站: 批踢踢實業坊(ptt.cc) 
</span>◆ From: 216.254.61.170
</div>
    
    <div id="article-polling" data-pollurl="/poll/Web_Design/M.1220558724.A.B95.html?cacheKey=2149-475814415&amp;offset=1501&amp;offset-sig=d254a3dd2aa063ee22ccd103287b6f93b442cb23" data-longpollurl="/v1/longpoll?id=3af56ecab1b8fd42e999a64eac7eacf9da2ef931" data-offset="1501"></div>
    

    
</div>

		

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-32365737-1', {
    cookieDomain: 'ptt.cc',
    legacyCookieDomain: 'ptt.cc'
  });
  ga('send', 'pageview');
</script>


		
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="//images.ptt.cc/bbs/v2.27/bbs.js"></script>

    <script type="text/javascript">(function(){window['__CF$cv$params']={r:'710ce9507a991ec4',m:'nmumJKwom9am_NbSMQ08j26.8rt4h3N7cJ7j8Mt96To-1653467451-0-ARdN4tsBZAwJoRj9Uw7zOESR3hQGVGaJOLDbCfPzR3cFydNilEgzaZcgoREpnSD/WlEtqFRn1OXC5iQmVu6Ac908GQXCXZ/qkI0BeoEazNIQr1z6mC/KnJXyWsplkz7QTLEtJJtaQYtZilRGA6FOLirI97gW9RqEyvBWIpsziOGi',s:[0xc045318970,0x0d0049f1f0],u:'/cdn-cgi/challenge-platform/h/g'}})();</script></body>
</html>
