<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		

<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Re: [請益] 如何使用7z來批次壓縮檔案？ - 看板 EZsoft - 批踢踢實業坊</title>
<meta name="robots" content="all">
<meta name="keywords" content="Ptt BBS 批踢踢">
<meta name="description" content="我的方法是在右鍵新增 7z 壓縮指令
然後搭配 Ctrl 或 Shift 選取多個檔案後按右鍵選單來批次壓縮
達到類似 WinRAR 的 &#34;一個檔案建立一個資料夾&#34; 的功能
右鍵有分資料夾 or 檔案，不過兩者所用的 command 是一樣的
[檔案]
">
<meta property="og:site_name" content="Ptt 批踢踢實業坊">
<meta property="og:title" content="Re: [請益] 如何使用7z來批次壓縮檔案？">
<meta property="og:description" content="我的方法是在右鍵新增 7z 壓縮指令
然後搭配 Ctrl 或 Shift 選取多個檔案後按右鍵選單來批次壓縮
達到類似 WinRAR 的 &#34;一個檔案建立一個資料夾&#34; 的功能
右鍵有分資料夾 or 檔案，不過兩者所用的 command 是一樣的
[檔案]
">
<link rel="canonical" href="https://www.ptt.cc/bbs/EZsoft/M.1204294621.A.9F5.html">

<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/bbs-common.css">
<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/bbs-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/bbs-custom.css">
<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/pushstream.css" media="screen">
<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/bbs-print.css" media="print">




	<script async src='/cdn-cgi/challenge-platform/h/g/scripts/invisible.js?ts=1653465600'></script></head>
    <body>
		
<div id="topbar-container">
	<div id="topbar" class="bbs-content">
		<a id="logo" href="/bbs/">批踢踢實業坊</a>
		<span>&rsaquo;</span>
		<a class="board" href="/bbs/EZsoft/index.html"><span class="board-label">看板 </span>EZsoft</a>
		<a class="right small" href="/about.html">關於我們</a>
		<a class="right small" href="/contact.html">聯絡資訊</a>
	</div>
</div>
<div id="navigation-container">
	<div id="navigation" class="bbs-content">
		<a class="board" href="/bbs/EZsoft/index.html">返回看板</a>
		<div class="bar"></div>
	</div>
</div>
<div id="main-container">
    <div id="main-content" class="bbs-screen bbs-content"><div class="article-metaline"><span class="article-meta-tag">作者</span><span class="article-meta-value">lcwmax (阿里山神木村拓哉)</span></div><div class="article-metaline-right"><span class="article-meta-tag">看板</span><span class="article-meta-value">EZsoft</span></div><div class="article-metaline"><span class="article-meta-tag">標題</span><span class="article-meta-value">Re: [請益] 如何使用7z來批次壓縮檔案？</span></div><div class="article-metaline"><span class="article-meta-tag">時間</span><span class="article-meta-value">Fri Feb 29 22:16:58 2008</span></div>
<span class="f2">※ 引述《taco20 (=S O M E  O N E=)》之銘言：
</span><span class="f6">: winrar有批次壓縮檔案的功能
</span><span class="f6">: 不過我覺得7z的壓縮率比較好
</span><span class="f6">: 我也喜歡這種陽春的感覺
</span><span class="f6">: 但很可惜的是7z似乎沒有批次壓縮這功能
</span><span class="f6">: 翻了精華區爬了文，似乎沒有具體的辦法
</span><span class="f6">: 只有看到一個 Drag and Drop Shell Robot 這個程式
</span><span class="f6">: 試了一下還是不太懂
</span><span class="f6">: 7z選項好像有外掛這一欄 ，還是說要用什麼外掛
</span><span class="f6">: 可以請教有什麼方便的方法可以用7z批次壓縮檔案嗎  謝謝～
</span>我的方法是在右鍵新增 7z 壓縮指令
然後搭配 Ctrl 或 Shift 選取多個檔案後按右鍵選單來批次壓縮
達到類似 WinRAR 的 &#34;一個檔案建立一個資料夾&#34; 的功能

右鍵有分資料夾 or 檔案，不過兩者所用的 command 是一樣的

[檔案]
1. 執行 regedit
2. 在 HKEY_LOCAL_MACHINE\SOFTWARE\Classes\*\shell\ 下新增一個機碼
   命名隨便，例如 &#34;<span class="f3 hl">加入 *.7z</span>&#34;
3. 在 HKEY_LOCAL_MACHINE\SOFTWARE\Classes\*\shell\<span class="f3 hl">加入 *.7z</span>\ 下再新增一個機碼
   命名為 &#34;command&#34;
4. command 內會有一個字串值叫 (預設值)，點兩下編輯
   輸入 <span class="f3 hl">&#34;C:\Program Files\7-Zip\7z.exe&#34; a -t7z &#34;%1&#34;.7z &#34;%1&#34;</span>

[資料夾]
   方法一樣，只是路徑改成 HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Folder\shell\


黃色的字可以根據自己需求修改，例如改成這樣就是壓縮成 zip 檔
        &#34;C:\Program Files\7-Zip\7z.exe&#34; a -tzip &#34;%1&#34;.zip &#34;%1&#34;
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ ^ ^^^^^ ^^^^^^^^ ^^^^
                       1                2   3       4     5
        1: 7-zip 路徑
        2: 動作:壓縮
        3: 格式:zip
        4: 壓縮檔的檔名
        5: 原始檔案的檔名
        %1 是檔名變數
        &#34;&#34; 引號是避免路徑有空格

詳細命令參數可以參考 7-zip 說明檔


但這方法有幾個缺憾
1. 壓完的檔案會包含原始檔案的附檔名，也就是 a.doc 壓縮完是 a.doc.zip
   雖不影響，只是和一般壓縮命名習慣不同
2. 壓縮過程會跳出 cmd 視窗，不知能否隱藏?
3. 是最大問題
   雖乍看像是批次壓縮，其實不是循序動作，而是所有檔案同時進行
   若是同時選一百個檔案同時壓縮，會有一百個 7z.exe 在執行壓縮動作
   當檔案量大時，無論是 cpu 或是硬碟都會吃不消吧



以下是懶人包，如果有板友想幫忙測試解決以上問題
將虛線之間內容(不含虛線)複製到純文字檔，將附檔名 txt 改成 reg
點兩下可以直接匯入

(zip 版)
------------------------
REGEDIT4

[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\*\shell\加入 *.zip\command]
@=&#34;\&#34;C:\\Program Files\\7-Zip\\7z.exe\&#34; a -tzip \&#34;%1\&#34;.zip \&#34;%1\&#34;&#34;

[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Folder\shell\加入 *.zip\command]
@=&#34;\&#34;C:\\Program Files\\7-Zip\\7z.exe\&#34; a -tzip \&#34;%1\&#34;.zip \&#34;%1\&#34;&#34;
------------------------

(7z 版)
------------------------
REGEDIT4
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\*\shell\加入 *.7z\command]
@=&#34;\&#34;C:\\Program Files\\7-Zip\\7z.exe\&#34; a -t7z \&#34;%1\&#34;.7z \&#34;%1\&#34;&#34;

[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Folder\shell\加入 *.7z\command]
@=&#34;\&#34;C:\\Program Files\\7-Zip\\7z.exe\&#34; a -t7z \&#34;%1\&#34;.7z \&#34;%1\&#34;&#34;
------------------------

網路上可以找到使用兩個 bat 檔來完成真正的批次壓縮
大家可以參考看看
<a href="https://sparanoid.com/blog/7-zip-452-beta-chinese-simplified/" target="_blank" rel="noreferrer noopener nofollow">http://sparanoid.com/blog/7-zip-452-beta-chinese-simplified/</a>

--
【帝江】
 有神焉，其狀如黃囊，赤如丹火，六足四翼，渾敦無面目，是識歌舞，實為帝江也。
 <a href="http://aycu31.webshots.com/image/14150/2006037017327500849_rs.jpg" target="_blank" rel="noreferrer noopener nofollow">http://aycu31.webshots.com/image/14150/2006037017327500849_rs.jpg</a>
<div class="richcontent"><img src="http://aycu31.webshots.com/image/14150/2006037017327500849_rs.jpg" alt="" loading="lazy" /></div>
 原來是個會唱歌的的屁股

--
<span class="f2">※ 發信站: 批踢踢實業坊(ptt.cc) 
</span>◆ From: 140.112.190.59
<div class="push"><span class="hl push-tag">推 </span><span class="f3 hl push-userid">taco20</span><span class="f3 push-content">:謝謝～</span><span class="push-ipdatetime"> 02/29 22:28
</span></div><div class="push"><span class="hl push-tag">推 </span><span class="f3 hl push-userid">vip82</span><span class="f3 push-content">:推專業</span><span class="push-ipdatetime"> 02/29 23:42
</span></div><div class="push"><span class="hl push-tag">推 </span><span class="f3 hl push-userid">xzjiang</span><span class="f3 push-content">:推一個，真是好文</span><span class="push-ipdatetime"> 03/01 00:06
</span></div><div class="push"><span class="hl push-tag">推 </span><span class="f3 hl push-userid">hellk</span><span class="f3 push-content">:winrar的批示壓縮方便多了</span><span class="push-ipdatetime"> 03/01 03:32
</span></div><div class="push"><span class="hl push-tag">推 </span><span class="f3 hl push-userid">ateclean</span><span class="f3 push-content">:樓上說的沒錯～ 不過7z不用去找破解也方便許多XD</span><span class="push-ipdatetime"> 03/01 12:57
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">ddtclon</span><span class="f3 push-content">:光看就頭大起來了 結果還是一個一個壓算了XD</span><span class="push-ipdatetime"> 03/01 15:49
</span></div></div>
    
    <div id="article-polling" data-pollurl="/poll/EZsoft/M.1204294621.A.9F5.html?cacheKey=2148-738954759&amp;offset=3742&amp;offset-sig=e4af68198dc67e2c40fb78ec5de15513e5a7968e" data-longpollurl="/v1/longpoll?id=9b2875093d2205999573565d4518f0b01ad2ea7a" data-offset="3742"></div>
    

    
</div>

		

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-32365737-1', {
    cookieDomain: 'ptt.cc',
    legacyCookieDomain: 'ptt.cc'
  });
  ga('send', 'pageview');
</script>


		
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="//images.ptt.cc/bbs/v2.27/bbs.js"></script>

    <script type="text/javascript">(function(){window['__CF$cv$params']={r:'710cdb502a47340e',m:'KcvSXCKiPX_y081O_Sv.XD8oqbCUyjjngMR.810phs0-1653466877-0-AW+hCh54GqDnNjlycQxFGc1J5RYewG9/ZpHboQ2xv9r6xs59y4ONcUDZ86xQtXnEbVll/EsoLfPlFg4lRTLoPAFHY1kE7ZUlNGWR+4JPmQE0U1geAY6thnPBQ0omuCVUwtECJK/qnVosHgh+n01693j349Qela8rpCbf73vJVQBp',s:[0xbb71529253,0xec73702f53],u:'/cdn-cgi/challenge-platform/h/g'}})();</script></body>
</html>
