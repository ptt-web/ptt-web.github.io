<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		

<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Re: [請益] 參數的傳遞問題 - 看板 PHP - 批踢踢實業坊</title>
<meta name="robots" content="all">
<meta name="keywords" content="Ptt BBS 批踢踢">
<meta name="description" content="可用session來記錄翻頁的參數, 以下提供的做法僅供示意參考:
&lt;?php
//開啟session:
session_start();
// page_no 及 direct 初始值指定:
">
<meta property="og:site_name" content="Ptt 批踢踢實業坊">
<meta property="og:title" content="Re: [請益] 參數的傳遞問題">
<meta property="og:description" content="可用session來記錄翻頁的參數, 以下提供的做法僅供示意參考:
&lt;?php
//開啟session:
session_start();
// page_no 及 direct 初始值指定:
">
<link rel="canonical" href="https://www.ptt.cc/bbs/PHP/M.1256977557.A.8A3.html">

<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/bbs-common.css">
<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/bbs-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/bbs-custom.css">
<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/pushstream.css" media="screen">
<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/bbs-print.css" media="print">




	<script async src='/cdn-cgi/challenge-platform/h/g/scripts/invisible.js?ts=1653465600'></script></head>
    <body>
		
<div id="topbar-container">
	<div id="topbar" class="bbs-content">
		<a id="logo" href="/bbs/">批踢踢實業坊</a>
		<span>&rsaquo;</span>
		<a class="board" href="/bbs/PHP/index.html"><span class="board-label">看板 </span>PHP</a>
		<a class="right small" href="/about.html">關於我們</a>
		<a class="right small" href="/contact.html">聯絡資訊</a>
	</div>
</div>
<div id="navigation-container">
	<div id="navigation" class="bbs-content">
		<a class="board" href="/bbs/PHP/index.html">返回看板</a>
		<div class="bar"></div>
	</div>
</div>
<div id="main-container">
    <div id="main-content" class="bbs-screen bbs-content"><div class="article-metaline"><span class="article-meta-tag">作者</span><span class="article-meta-value">bobju (寶貝豬)</span></div><div class="article-metaline-right"><span class="article-meta-tag">看板</span><span class="article-meta-value">PHP</span></div><div class="article-metaline"><span class="article-meta-tag">標題</span><span class="article-meta-value">Re: [請益] 參數的傳遞問題</span></div><div class="article-metaline"><span class="article-meta-tag">時間</span><span class="article-meta-value">Sat Oct 31 16:25:55 2009</span></div>
可用session來記錄翻頁的參數, 以下提供的做法僅供示意參考:
&lt;?php
//開啟session:
session_start();

// page_no 及 direct 初始值指定:
if(!isset($_SESSION[&#39;page_no&#39;]))
 $_SESSION[&#39;page_no&#39;] = 1; // page_no 是1-base, 1就是代表頭頁.

if(!isset($_SESSION[&#39;direct&#39;]))
 $_SESSION[&#39;direct&#39;] = &#39;DESC&#39;;

if(!isset($_SESSION[&#39;page_size&#39;]))
 $_SESSION[&#39;page_size&#39;] = 10;

// 若 page_no 及 direct 有新值傳入, 則session的記錄值也要更新.
// (若無, 當然就無需變動)
if(isset($_REQUEST[&#39;page_no&#39;]))
 $_SESSION[&#39;page_no&#39;] = $_REQUEST[&#39;page_no&#39;];

if(isset($_REQUEST[&#39;direct&#39;]))
 $_SESSION[&#39;page_no&#39;] = $_REQUEST[&#39;direct&#39;];

$sql=sprintf(&#34;
 select *
 from myrecords
 where 1=1
 order by %s %s
limit %d,%d
&#34;,
&#39;id&#39;,
strtoupper($_SESSION[&#39;direct&#39;]),
($_SESSION[&#39;page_no&#39;]-1)*$_SESSION[&#39;page_size&#39;],
$_SESSION[&#39;page_size&#39;]
);

//撈資料

//套表輸出

?&gt;

這樣的話, 只有在要換頁或是換排序方向時才需要在url上指定,

不然的話, 只會一直沿用舊值來顯示頁面. 例:

hxxp://bobju.cxm/a.php?page_no=5&amp;direct=DESC  //以倒序排資料,顯示第5頁.

hxxp://bobju.cxm/a.php //由於沒有指定page_no 及 direct, 所以沿用
                       //存在session當中的 page_no 及 direct 值,
                       //仍然以倒序排資料, 顯示第5頁.

偏好每次翻頁都採用以 url 來傳參數的理由當中, 其中之一是為了在web server

的日誌上留下記錄, 這從系統維護的角度來看, 有其意義在. 若用session來做的

話, 那就得自己在程式當中另外設計了.

<span class="f2">※ 引述《rs6000 (小叮噹)》之銘言：
</span><span class="f6">: 小弟目前自修PHP練習時發現一點問題想請教板上的前輩們
</span><span class="f6">: 問題是這樣的，我照書上的範例做一個留言板
</span><span class="f6">: 裡頭有分頁與排序的功能(可選日期或點閱數)
</span><span class="f6">: 這兩個功能單獨用的時後是正常的。
</span><span class="f6">: 但是無法合在一起用
</span><span class="f6">: 尤其是點到其他分頁的時後再去按排序的功能
</span><span class="f6">: 就會跳回第一頁。
</span><span class="f6">: 由於書上的範例原本就有這個BUG。
</span><span class="f6">: 我想應該是參數的傳遞上有缺陷
</span><span class="f6">: 在我直接在網址列自行加上參數
</span><span class="f6">: 網址:index_pub.php?page_num=2&amp;sort=coun desc
</span><span class="f6">: 這樣才能在分頁上做排序
</span><span class="f6">: 要怎樣才能直接在程式中控制
</span><span class="f6">: 跳到其他分頁時還能做排序的功能而設定不會跑掉呢?
</span><span class="f6">: ps:板上有人買過文魁出版羅毅志先先寫的 PHP5+MySQL互動式網頁設計嗎?
</span><span class="f6">: 書上的範例與光碟的檔案都無法執行...Orz
</span><span class="f6">: 我才看到第4章就花不少時間除錯~程式才能跑 &gt;&#34;&lt;
</span><span class="f2">※ 編輯: bobju           來自: 58.115.151.184       (10/31 18:40)
</span><div class="push"><span class="hl push-tag">推 </span><span class="f3 hl push-userid">rs6000</span><span class="f3 push-content">:感謝大大的指點～</span><span class="push-ipdatetime"> 10/31 21:26
</span></div></div>
    
    <div id="article-polling" data-pollurl="/poll/PHP/M.1256977557.A.8A3.html?cacheKey=2148-469794006&amp;offset=2326&amp;offset-sig=566fb25ac150d6996ce4c60dddf841028168186d" data-longpollurl="/v1/longpoll?id=c02618efde4f3583b8341fb70295b28ad384b73a" data-offset="2326"></div>
    

    
</div>

		

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-32365737-1', {
    cookieDomain: 'ptt.cc',
    legacyCookieDomain: 'ptt.cc'
  });
  ga('send', 'pageview');
</script>


		
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="//images.ptt.cc/bbs/v2.27/bbs.js"></script>

    <script type="text/javascript">(function(){window['__CF$cv$params']={r:'710cea4bbd89af5e',m:'CyHfOlD7r_xkkeeEo7lon.HvNueAKfQazvlDAYlfOxk-1653467491-0-Af2Y4T7M3zHsacy/fZ5E3X+1xWXdiLA9ZsPaUcwE7LjshKCAFvjQ0i+1jpIJwuBKMPK8EqO2HepABtk9oZ/W9nghV8psQb4sfIwoX6wTa/Z9ogev+Q51f9vwp9V1Q7uRoCqWfK+ayGPA9lQZCQ71iIrY5/Z4qL8YGtISMRLAuZWK',s:[0x44ac013e0e,0x3d0b666c4c],u:'/cdn-cgi/challenge-platform/h/g'}})();</script></body>
</html>
