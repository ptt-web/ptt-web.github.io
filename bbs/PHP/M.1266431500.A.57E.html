<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		

<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Re: [請益] 用php去設定cron - 看板 PHP - 批踢踢實業坊</title>
<meta name="robots" content="all">
<meta name="keywords" content="Ptt BBS 批踢踢">
<meta name="description" content="→ s66449:我有疑問耶...因為我是第一次寫這東西 到底那隻xx.php       02/18 00:47
→ s66449:長怎樣???我直接用cron去執行我那個網頁就好了 為什麼還要   02/18 00:48
→ s66449:再寫一隻xx.php去執行我那個網頁??                         02/18 00:49
→ s66449:我有嘗試去google  可是我不知怎麼下關鍵字&gt; &lt;              02/18 00:51
→ s66449:找到的都不是我要的                                       02/18 00:51
">
<meta property="og:site_name" content="Ptt 批踢踢實業坊">
<meta property="og:title" content="Re: [請益] 用php去設定cron">
<meta property="og:description" content="→ s66449:我有疑問耶...因為我是第一次寫這東西 到底那隻xx.php       02/18 00:47
→ s66449:長怎樣???我直接用cron去執行我那個網頁就好了 為什麼還要   02/18 00:48
→ s66449:再寫一隻xx.php去執行我那個網頁??                         02/18 00:49
→ s66449:我有嘗試去google  可是我不知怎麼下關鍵字&gt; &lt;              02/18 00:51
→ s66449:找到的都不是我要的                                       02/18 00:51
">
<link rel="canonical" href="https://www.ptt.cc/bbs/PHP/M.1266431500.A.57E.html">

<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/bbs-common.css">
<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/bbs-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/bbs-custom.css">
<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/pushstream.css" media="screen">
<link rel="stylesheet" type="text/css" href="//images.ptt.cc/bbs/v2.27/bbs-print.css" media="print">




	<script async src='/cdn-cgi/challenge-platform/h/g/scripts/invisible.js?ts=1653465600'></script></head>
    <body>
		
<div id="topbar-container">
	<div id="topbar" class="bbs-content">
		<a id="logo" href="/bbs/">批踢踢實業坊</a>
		<span>&rsaquo;</span>
		<a class="board" href="/bbs/PHP/index.html"><span class="board-label">看板 </span>PHP</a>
		<a class="right small" href="/about.html">關於我們</a>
		<a class="right small" href="/contact.html">聯絡資訊</a>
	</div>
</div>
<div id="navigation-container">
	<div id="navigation" class="bbs-content">
		<a class="board" href="/bbs/PHP/index.html">返回看板</a>
		<div class="bar"></div>
	</div>
</div>
<div id="main-container">
    <div id="main-content" class="bbs-screen bbs-content"><div class="article-metaline"><span class="article-meta-tag">作者</span><span class="article-meta-value">weiyucsie (選擇那刻 才算開始)</span></div><div class="article-metaline-right"><span class="article-meta-tag">看板</span><span class="article-meta-value">PHP</span></div><div class="article-metaline"><span class="article-meta-tag">標題</span><span class="article-meta-value">Re: [請益] 用php去設定cron</span></div><div class="article-metaline"><span class="article-meta-tag">時間</span><span class="article-meta-value">Thu Feb 18 02:31:36 2010</span></div>
<div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:我有疑問耶...因為我是第一次寫這東西 到底那隻xx.php</span><span class="push-ipdatetime"> 02/18 00:47
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:長怎樣???我直接用cron去執行我那個網頁就好了 為什麼還要</span><span class="push-ipdatetime"> 02/18 00:48
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:再寫一隻xx.php去執行我那個網頁??</span><span class="push-ipdatetime"> 02/18 00:49
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:我有嘗試去google  可是我不知怎麼下關鍵字&gt; &lt;</span><span class="push-ipdatetime"> 02/18 00:51
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:找到的都不是我要的</span><span class="push-ipdatetime"> 02/18 00:51
</span></div>
假設我們有兩隻php，一隻是web.php，一隻是fromCron.php
web.php:使用者操作，儲存資料
fromCron.php:讀取資料，進行使用者指定動作
(我是覺得寫在一起很怪啦，也不是不能寫在一起)

crontab裡面可能有一行
* * * * * /usr/local/bin/php /我的路徑/fromCron.php

然後
fromCron.php可能
$data = 讀取資料();
if (時間是使用者指定的時間) {
        進行動作
}

這是我的想法啦(沒想到還是要多發一篇@<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="5e701e">[email&#160;protected]</a>)

xx.php執行的是使用者要求的東西
不是執行那個網頁

--
<span class="f2">※ 發信站: 批踢踢實業坊(ptt.cc)
</span>◆ From: 125.231.172.151
<div class="push"><span class="hl push-tag">推 </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:謝謝你這麼熱心...我有個疑問 試著在shell下執行我那個php</span><span class="push-ipdatetime"> 02/18 12:11
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:結果執行的結果指示出現整個網頁的原始碼 而不是按了scan</span><span class="push-ipdatetime"> 02/18 12:12
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:button 完後的結果  是我那個網頁還得要做什麼設定嗎??</span><span class="push-ipdatetime"> 02/18 12:12
</span></div>這我可能沒注意到
你的web.php可能除了 操作、儲存 外
還有執行的動作

但是php cli模式下，就當成一般的script執行
web上的&lt;html&gt;等標籤，在cli模式下，因為沒有瀏覽器解釋
所以都是直接吐給你看的
(所以其實你要將fromCron.php改用其他語言，
變成fromCron.pl，或是寫成執行檔，其實也沒差，
只不過反正web都用php寫了，fromCron的部份用php寫，
資料庫的存取就不用另外再學一套...如果用的是資料庫的話:p
另外一點是，你的執行部分共用比較彈性)

假設web.php的內容是：
[code]
&lt;?php
if (GET或POST輸入) {
  依據GET或POST動作
    *包含儲存動作
    *執行(scan)
}
?&gt;呈現頁面
[/code]

那我們就必須把執行的部份區分出來

可能是另外一個頁面，或是額外的function
(這邊參數自己看要哪些，
怎麼處理，這裡只是範例)
scan.php
[code]
function scan($host, $port) {
  ...
}
[/code]

web.php的部份
執行就改成
[code]
require(&#39;scan.php&#39;);
scan($host, $port);
[/code]

然後fromCron.php的進行動作部分
可能就改成
[code]
require(&#39;scan.php&#39;);
scan($host, $port);
[/code]
這樣之類的...


如果不懂php-cli的話
其實還有個方法，比較耗費資源
你把執行部分額外變成一個可以執行的網址
就可以寫成一般網頁的形式XD
(不過內容無意義就是了)
crontab的內容可能是
* * * * * wget <a href="http://localhost/PATH/fromCron.php" target="_blank" rel="noreferrer noopener nofollow">http://localhost/PATH/fromCron.php</a>
就是crontab去抓網頁
(當然這樣可能會多抓網頁就是了XD)

ps.以上提的也只是一種實作方法啦
<span class="f2">※ 編輯: weiyucsie       來自: 125.231.174.29       (02/18 14:05)
</span><div class="push"><span class="hl push-tag">推 </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:我有點搞混了...怎麼又會多一個scan.php 總共要寫三個php嗎</span><span class="push-ipdatetime"> 02/18 19:01
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:fromCron.php就是ㄧ個空白網頁 然後裡面都是去執行web.php</span><span class="push-ipdatetime"> 02/18 19:02
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:使用者要求的東西嗎??</span><span class="push-ipdatetime"> 02/18 19:03
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:還想要一下@@&#34; 因為你說在shell下執行php的話 因為沒瀏覽器</span><span class="push-ipdatetime"> 02/18 19:04
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:支援 所以執行結果都是整個畫面的程式碼  要是有人說一個</span><span class="push-ipdatetime"> 02/18 19:04
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:php程式能不能在shell下執行 只要能跑出網頁原始檔就代表</span><span class="push-ipdatetime"> 02/18 19:05
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:這支php是可以在shell執行的意思嗎??</span><span class="push-ipdatetime"> 02/18 19:05
</span></div><div class="push"><span class="hl push-tag">推 </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">: 最後打的那段cron跟前面的* * * * * /usr/local/bin/php..</span><span class="push-ipdatetime"> 02/18 19:11
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:有什麼不同??不都是任何時間去檢查fromCron這隻網頁嗎??</span><span class="push-ipdatetime"> 02/18 19:12
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:ㄧ直問...真是不好意思&gt; &lt;</span><span class="push-ipdatetime"> 02/18 19:13
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">weiyucsie</span><span class="f3 push-content">:那... 你再描述一下你目前想的好了&gt;.&lt;</span><span class="push-ipdatetime"> 02/18 20:09
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">weiyucsie</span><span class="f3 push-content">:沒什麼不同 只不過一個是經過網頁伺服器(wget)</span><span class="push-ipdatetime"> 02/18 20:10
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">weiyucsie</span><span class="f3 push-content">:一個沒有</span><span class="push-ipdatetime"> 02/18 20:10
</span></div><div class="push"><span class="hl push-tag">推 </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:我想把我理解的講出來  不知道有沒有誤解你的意思</span><span class="push-ipdatetime"> 02/18 22:33
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:我就再寫一隻formCron.php程式 然後再去主機加上</span><span class="push-ipdatetime"> 02/18 22:34
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:* * * * * /usr/local/bin/php /我的路徑/fromCron.php</span><span class="push-ipdatetime"> 02/18 22:34
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:讓fromCron每天不斷的去check web.php看使用者有沒有按下</span><span class="push-ipdatetime"> 02/18 22:35
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:scan button 然後去執行使用者要求的東西</span><span class="push-ipdatetime"> 02/18 22:37
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:然後因為我所有執行的指令都在web.php 所以我得要再把</span><span class="push-ipdatetime"> 02/18 22:38
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:那些指令程式碼寫進fromCron.php  是這樣嗎??</span><span class="push-ipdatetime"> 02/18 22:39
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:那我那個網頁是要user輸入定時掃瞄時間的 那要怎麼跟</span><span class="push-ipdatetime"> 02/18 22:41
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">s66449</span><span class="f3 push-content">:fromCron.php網頁做結合呢??</span><span class="push-ipdatetime"> 02/18 22:43
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">weiyucsie</span><span class="f3 push-content">:&#34;check web.php看使用者有沒有按下scan button&#34; 關於這</span><span class="push-ipdatetime"> 02/18 23:48
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">weiyucsie</span><span class="f3 push-content">:我是想說 scan button是即時的掃描</span><span class="push-ipdatetime"> 02/18 23:48
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">weiyucsie</span><span class="f3 push-content">:(這邊你的掃描應該等於執行的動作吧？)</span><span class="push-ipdatetime"> 02/18 23:48
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">weiyucsie</span><span class="f3 push-content">:fromCron.php則是使用者送出資料後，時間到才去執行的</span><span class="push-ipdatetime"> 02/18 23:49
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">weiyucsie</span><span class="f3 push-content">:所有執行的指令都在web.php 要寫進fromCron.php</span><span class="push-ipdatetime"> 02/18 23:50
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">weiyucsie</span><span class="f3 push-content">:這是我想說額外存一個php，其他兩個php用require的部份</span><span class="push-ipdatetime"> 02/18 23:51
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">weiyucsie</span><span class="f3 push-content">:你的fromCron寫進crontab後，每分鐘會被執行</span><span class="push-ipdatetime"> 02/18 23:52
</span></div><div class="push"><span class="f1 hl push-tag">→ </span><span class="f3 hl push-userid">weiyucsie</span><span class="f3 push-content">:那就看你怎麼判斷要不要執行 來達到所指定的幾分鐘</span><span class="push-ipdatetime"> 02/18 23:55
</span></div></div>
    
    <div id="article-polling" data-pollurl="/poll/PHP/M.1266431500.A.57E.html?cacheKey=2148-469790206&amp;offset=5765&amp;offset-sig=932928ba31295d248736c3acec36d1043bd8a59c" data-longpollurl="/v1/longpoll?id=4c744c76cd6ca1cae0b2bf91e47327055289f6cd" data-offset="5765"></div>
    

    
</div>

		

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-32365737-1', {
    cookieDomain: 'ptt.cc',
    legacyCookieDomain: 'ptt.cc'
  });
  ga('send', 'pageview');
</script>


		
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="//images.ptt.cc/bbs/v2.27/bbs.js"></script>

    <script type="text/javascript">(function(){window['__CF$cv$params']={r:'710cea6b3cc7af5e',m:'QtF.wu1kvTmGwK7ErQXYV5D0uDG8FQCIZDUS43m7ubc-1653467496-0-AboLgtQlBOrduOw7RLMr5IThp129NSE5An/MxDIkbDZ7wzft4uhbtpzg0pNwq1wYOHN4PpSRLKTB5BqhDiGb2xWEpTFxzLES6xkXtGw2b1H5KxJYynpFOP4MwSO2HTLJj6Sc5lCj92YYFZFY3EqvX0P84dYcLnaLvEPvuigsvI5h',s:[0x91b9b977d6,0x5f52f22c76],u:'/cdn-cgi/challenge-platform/h/g'}})();</script></body>
</html>
